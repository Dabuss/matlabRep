function H_0_i = getFkIiwa(q, tcpPoseEuler)
% angles given in radians
% gives the 8 homogeneous transformation corresponding to the 7 Oi frames in
% 0 and the tcp frame in 0

c1 = cos(q(1));
c2 = cos(q(2));
c3 = cos(q(3));
c4 = cos(q(4));
c5 = cos(q(5));
c6 = cos(q(6));
c7 = cos(q(7));

s1 = sin(q(1));
s2 = sin(q(2));
s3 = sin(q(3));
s4 = sin(q(4));
s5 = sin(q(5));
s6 = sin(q(6));
s7 = sin(q(7));


H_0_1= ...
[[ c1, -s1, 0,   0];
[ s1,  c1, 0,   0];
[       0,        0, 1, 360];
[       0,        0, 0,   1]];

% H_0_2 = H_0_1 * [c2 -s2, 0, 0; 0, 0, 1, 0; -s2, -c2, 0, 0; 0, 0, 0, 1];

H_0_2= ...
[[ c1*c2, -c1*s2, -s1,   0];
[ c2*s1, -s1*s2,  c1,   0];
[        -s2,         -c2,        0, 360];
[               0,                0,        0,   1]];

% H_0_3 = H_0_2 * [c3 -s3, 0, 0; 0, 0, -1, -420; s3, c3, 0, 0; 0, 0, 0, 1];

H_0_3= ...
[[ c1*c2*c3 - s1*s3, - c3*s1 - c1*c2*s3, c1*s2, 420*c1*s2];
[ c1*s3 + c2*c3*s1,   c1*c3 - c2*s1*s3, s1*s2, 420*s1*s2];
[                          -c3*s2,                             s2*s3,         c2,   420*c2 + 360];
[                                         0,                                           0,               0,                   1]];
 
H_0_4= ...
[[ c1*s2*s4 - c4*(s1*s3 - c1*c2*c3), s4*(s1*s3 - c1*c2*c3) + c1*c4*s2, c3*s1 + c1*c2*s3, 420*c1*s2];
[ c4*(c1*s3 + c2*c3*s1) + s1*s2*s4, c4*s1*s2 - s4*(c1*s3 + c2*c3*s1), c2*s1*s3 - c1*c3, 420*s1*s2];
[                                     c2*s4 - c3*c4*s2,                                     c2*c4 + c3*s2*s4,                          -s2*s3,   420*c2 + 360];
[                                                                             0,                                                                             0,                                         0,                   1]];

H_0_5= ...
[[ - c5*(c4*(s1*s3 - c1*c2*c3) - c1*s2*s4) - s5*(c3*s1 + c1*c2*s3), s5*(c4*(s1*s3 - c1*c2*c3) - c1*s2*s4) - c5*(c3*s1 + c1*c2*s3), s4*(s1*s3 - c1*c2*c3) + c1*c4*s2, 420*c1*s2 + 400*s4*(s1*s3 - c1*c2*c3) + 400*c1*c4*s2];
[   c5*(c4*(c1*s3 + c2*c3*s1) + s1*s2*s4) + s5*(c1*c3 - c2*s1*s3), c5*(c1*c3 - c2*s1*s3) - s5*(c4*(c1*s3 + c2*c3*s1) + s1*s2*s4), c4*s1*s2 - s4*(c1*s3 + c2*c3*s1), 420*s1*s2 - 400*s4*(c1*s3 + c2*c3*s1) + 400*c4*s1*s2];
[                                                                   c5*(c2*s4 - c3*c4*s2) + s2*s3*s5,                                                                 c5*s2*s3 - s5*(c2*s4 - c3*c4*s2),                                     c2*c4 + c3*s2*s4,                                       420*c2 + 400*c2*c4 + 400*c3*s2*s4 + 360];
[                                                                                                                                               0,                                                                                                                                             0,                                                                             0,                                                                                                           1]];

H_0_6= ...
[[ - s6*(s4*(s1*s3 - c1*c2*c3) + c1*c4*s2) - c6*(c5*(c4*(s1*s3 - c1*c2*c3) - c1*s2*s4) + s5*(c3*s1 + c1*c2*s3)), s6*(c5*(c4*(s1*s3 - c1*c2*c3) - c1*s2*s4) + s5*(c3*s1 + c1*c2*s3)) - c6*(s4*(s1*s3 - c1*c2*c3) + c1*c4*s2), s5*(c4*(s1*s3 - c1*c2*c3) - c1*s2*s4) - c5*(c3*s1 + c1*c2*s3), 420*c1*s2 + 400*s4*(s1*s3 - c1*c2*c3) + 400*c1*c4*s2];
[   s6*(s4*(c1*s3 + c2*c3*s1) - c4*s1*s2) + c6*(c5*(c4*(c1*s3 + c2*c3*s1) + s1*s2*s4) + s5*(c1*c3 - c2*s1*s3)), c6*(s4*(c1*s3 + c2*c3*s1) - c4*s1*s2) - s6*(c5*(c4*(c1*s3 + c2*c3*s1) + s1*s2*s4) + s5*(c1*c3 - c2*s1*s3)), c5*(c1*c3 - c2*s1*s3) - s5*(c4*(c1*s3 + c2*c3*s1) + s1*s2*s4), 420*s1*s2 - 400*s4*(c1*s3 + c2*c3*s1) + 400*c4*s1*s2];
[                                                                                                       c6*(c5*(c2*s4 - c3*c4*s2) + s2*s3*s5) - s6*(c2*c4 + c3*s2*s4),                                                                                                   - s6*(c5*(c2*s4 - c3*c4*s2) + s2*s3*s5) - c6*(c2*c4 + c3*s2*s4),                                                                 c5*s2*s3 - s5*(c2*s4 - c3*c4*s2),                                       420*c2 + 400*c2*c4 + 400*c3*s2*s4 + 360];
[                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                 0,                                                                                                                                             0,                                                                                                           1]];

% H_0_7 = H_0_6 * [c7 -s7, 0, 0; 0, 0, -1, -126; s7, c7, 0, 0; 0, 0, 0, 1];

H_0_7= ...
[[ s7*(s5*(c4*(s1*s3 - c1*c2*c3) - c1*s2*s4) - c5*(c3*s1 + c1*c2*s3)) - c7*(s6*(s4*(s1*s3 - c1*c2*c3) + c1*c4*s2) + c6*(c5*(c4*(s1*s3 - c1*c2*c3) - c1*s2*s4) + s5*(c3*s1 + c1*c2*s3))),   s7*(s6*(s4*(s1*s3 - c1*c2*c3) + c1*c4*s2) + c6*(c5*(c4*(s1*s3 - c1*c2*c3) - c1*s2*s4) + s5*(c3*s1 + c1*c2*s3))) + c7*(s5*(c4*(s1*s3 - c1*c2*c3) - c1*s2*s4) - c5*(c3*s1 + c1*c2*s3)), c6*(s4*(s1*s3 - c1*c2*c3) + c1*c4*s2) - s6*(c5*(c4*(s1*s3 - c1*c2*c3) - c1*s2*s4) + s5*(c3*s1 + c1*c2*s3)), 420*c1*s2 + 126*c6*(s4*(s1*s3 - c1*c2*c3) + c1*c4*s2) - 126*s6*(c5*(c4*(s1*s3 - c1*c2*c3) - c1*s2*s4) + s5*(c3*s1 + c1*c2*s3)) + 400*s4*(s1*s3 - c1*c2*c3) + 400*c1*c4*s2];
[ c7*(s6*(s4*(c1*s3 + c2*c3*s1) - c4*s1*s2) + c6*(c5*(c4*(c1*s3 + c2*c3*s1) + s1*s2*s4) + s5*(c1*c3 - c2*s1*s3))) - s7*(s5*(c4*(c1*s3 + c2*c3*s1) + s1*s2*s4) - c5*(c1*c3 - c2*s1*s3)), - s7*(s6*(s4*(c1*s3 + c2*c3*s1) - c4*s1*s2) + c6*(c5*(c4*(c1*s3 + c2*c3*s1) + s1*s2*s4) + s5*(c1*c3 - c2*s1*s3))) - c7*(s5*(c4*(c1*s3 + c2*c3*s1) + s1*s2*s4) - c5*(c1*c3 - c2*s1*s3)), s6*(c5*(c4*(c1*s3 + c2*c3*s1) + s1*s2*s4) + s5*(c1*c3 - c2*s1*s3)) - c6*(s4*(c1*s3 + c2*c3*s1) - c4*s1*s2), 420*s1*s2 - 126*c6*(s4*(c1*s3 + c2*c3*s1) - c4*s1*s2) + 126*s6*(c5*(c4*(c1*s3 + c2*c3*s1) + s1*s2*s4) + s5*(c1*c3 - c2*s1*s3)) - 400*s4*(c1*s3 + c2*c3*s1) + 400*c4*s1*s2];
[                                                                                                                                                                     c7*(c6*(c5*(c2*s4 - c3*c4*s2) + s2*s3*s5) - s6*(c2*c4 + c3*s2*s4)) - s7*(s5*(c2*s4 - c3*c4*s2) - c5*s2*s3),                                                                                                                                                                     - c7*(s5*(c2*s4 - c3*c4*s2) - c5*s2*s3) - s7*(c6*(c5*(c2*s4 - c3*c4*s2) + s2*s3*s5) - s6*(c2*c4 + c3*s2*s4)),                                                                                                     s6*(c5*(c2*s4 - c3*c4*s2) + s2*s3*s5) + c6*(c2*c4 + c3*s2*s4),                                                                                                                                           420*c2 + 400*c2*c4 + 126*s6*(c5*(c2*s4 - c3*c4*s2) + s2*s3*s5) + 126*c6*(c2*c4 + c3*s2*s4) + 400*c3*s2*s4 + 360];
[                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                 0,                                                                                                                                                                                                                                                                                                                                                                       1]];



H_7_tcp = poseEulerZYXToTransf(tcpPoseEuler);

H_0_tcp = H_0_7*H_7_tcp;


H_0_i = {H_0_1, H_0_2, H_0_3, H_0_4, H_0_5, H_0_6, H_0_7, H_0_tcp};
end